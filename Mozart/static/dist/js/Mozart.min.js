/*! Mozart 07-02-2015 */
"use strict";var app=angular.module("mozArtApp",["ngTagsInput","angularFileUpload","ng.django.forms"]);app.config(["$interpolateProvider","$httpProvider",function(a,b){a.startSymbol("{$"),a.endSymbol("$}"),b.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]),app.directive("fileUpload",[function(){return{scope:{fileBind:"="},link:function(a,b){b.bind("change",function(b){for(var c=b.target.files,d=0;d<c.length;d++)a.$emit(a.fileBind,{file:c[d]})})}}}]),app.directive("offClick",["$document","$timeout",function(a,b){function c(a,b){if(!a||!b)return!1;for(var c=angular.element(document.querySelectorAll(b)),d=c.length,e=0;d>e;++e)if(c[e].contains(a))return!0;return!1}return{restrict:"A",scope:{offClick:"&",offClickIf:"&"},link:function(d,e,f){function g(a){if(0!=a.pageX||0!=a.pageY){var b=a.target||a.srcElement;e[0].contains(b)||c(b,f.offClickFilter)||d.$apply(d.offClick())}}f.offClickIf?d.$watch(d.offClickIf,function(c,d){c&&!d?b(function(){a.on("click",g)}):c||a.off("click",g)}):a.on("click",g),d.$on("$destroy",function(){a.off("click",g)})}}}]),app.directive("modalDialog",function(){return{restrict:"E",scope:{show:"=",tituloVentana:"@"},replace:!0,transclude:!0,link:function(a){a.hideModal=function(){a.show=!1}},templateUrl:"scripts/directives/ventanaModal.html"}}),app.directive("comparar",function(){return{restrict:"A",require:"ngModel",scope:{compareTo:"=comparar"},link:function(a,b,c,d){a.validar=function(){return a.compareTo===d.$modelValue},a.$watch(a.validar,function(a){d.$setValidity("noIguales",a)})}}}),app.directive("mzField",function(){return{restrict:"C",link:function(a,b,c){var d="#"+c.id;angular.element(d).focus(function(){angular.element(d).prev("label").css("width","0%"),angular.element(d).prev("label").css("padding","5px 0"),angular.element(d).css("width","90%")}),angular.element(d).blur(function(){angular.element(d).prev("label").css("padding","5px 10px"),angular.element(d).prev("label").css("width","30%"),angular.element(d).css("width","60%")})}}}),app.controller("cargarObrasCtrl",["$scope","peticionObras",function(a,b){a.cantidad=5,a.categoria="a",a.cargar=function(c){b.get(function(b){a.obras=b},function(a,b){alert("Ha fallado la petición. Estado HTTP:"+b)},"recientes",a.categoria,"todos",c),a.cantidad+=4},a.cargar(a.cantidad),a.prueba="http://www.google.com"}]),app.controller("editarInformacionCtrl",["$scope",function(a){a.videoValido=!0,a.portadaValida=!0,a.imagenValida=!0,a.video={name:""},a.portada={name:""},a.imagen={name:""},a.$on("archivoVideo",function(b,c){a.$apply(function(){a.video=c.file,divisiones=a.video.name.split("."),a.formatoVideo=divisiones[divisiones.length-1],a.videoValido=a.verificarVideo(a.formatoVideo)})}),a.$on("archivoPortada",function(b,c){a.$apply(function(){a.portada=c.file,divisiones=a.portada.name.split("."),a.formatoPortada=divisiones[divisiones.length-1],a.portadaValida=a.verificarImagen(a.formatoPortada)})}),a.$on("archivoImagen",function(b,c){a.$apply(function(){a.imagen=c.file,divisiones=a.imagen.name.split("."),a.formatoImagen=divisiones[divisiones.length-1],a.imagenValida=a.verificarImagen(a.formatoImagen)})}),a.verificarVideo=function(a){for(formatosVideo=["mp4","mpeg","avi","3gp"],i=0;i<formatosVideo.length;i++)if(a==formatosVideo[i])return!0;return!1},a.verificarImagen=function(a){for(formatosImagen=["png","gif","jpg","jpeg","bmp","tiff"],i=0;i<formatosImagen.length;i++)if(a==formatosImagen[i])return!0;return!1}}]),app.controller("errorCtrl",["$scope","$routeParams","peticionObras",function(a,b,c){a.cantidad=3,a.cargar=function(){c.get(function(b){a.obras=b},function(a,b){alert("Ha fallado la petición. Estado HTTP:"+b)},"aleatorio","todas","todos",a.cantidad)},a.cargar()}]),app.controller("formularioRegistroCtrl",["$scope",function(a){a.acepto=!1,a.fechaValida=!0,a.mayorEdad=!0,a.nicknameValido=!0,a.nicknamePrueba="holi crayholi",a.emailValido=!0,a.emailPrueba="aaa@aaa.com",a.fecha_actual=new Date,a.this_year=parseInt(a.fecha_actual.getYear())+1900,a.validarFecha=function(){var b=new Date(a.year,a.mes,"0"),c=parseInt(a.fecha_actual.getMonth()+1),d=parseInt(a.fecha_actual.getDate()),e=a.this_year-a.year;a.fechaValida=a.dia-0>b.getDate()-0?!1:!0,c<a.mes&&e--,a.mes==c&&d<a.dia&&e--,e>1900&&(e-=1900),a.mayorEdad=e>=18?!0:!1},a.verificarNickname=function(){a.nicknameValido=a.nickname==a.nicknamePrueba?!1:!0},a.verificarEmail=function(){a.emailValido=a.email==a.emailPrueba?!1:!0},a.validar=function(){return!(!a.fechaValida||!a.mayorEdad||!a.emailValido||!a.nicknameValido||a.registro.$invalid)}}]),app.controller("menuDerechoCtrl",["$scope",function(a){a.visible=!1,a.posicion1={right:"-305px"},a.posicion2={right:"0"},a.posicionDerecha=a.posicion1,a.mostrarMenu=function(){1==a.visible?(a.posicionDerecha=a.posicion1,a.visible=!1):(a.posicionDerecha=a.posicion2,a.visible=!0)}}]),app.controller("menuIzquierdoCtrl",["$scope",function(a){a.visible=!1,a.posicion1={left:"-305px"},a.posicion2={left:"0"},a.posicionIzquierda=a.posicion1,a.mostrarMenu=function(){1==a.visible?(a.posicionIzquierda=a.posicion1,a.visible=!1):(a.posicionIzquierda=a.posicion2,a.visible=!0)}}]),app.controller("modalCtrl",["$scope",function(a){a.modalShown=!1,a.toggleModal=function(){a.modalShown=!a.modalShown}}]),app.controller("perfilArtistaCtrl",["$scope","$log",function(a,b){b.log("Hola")}]),app.controller("perfilPromotorCtrl",["$scope","$log",function(a,b){b.log("Hola")}]),app.controller("informacionPerfilCtrl",["$scope","$log",function(a,b){b.log("Hola")}]),app.controller("configuracionesCtrl",["$scope",function(a){a.validar=function(){alert("Hola "+a.email+"!")}}]),app.controller("loginCtrl",["$scope",function(a){a.validar=function(){alert("Hola "+a.email+"!")}}]),app.controller("subirObraCtrl",["$scope",function(a){a.maxeti=30,a.archivo={name:""},a.portada={name:""},a.formatoArchivo="",a.formatoPortada="",a.archivoImagen=!0,a.archivoValido=!1,a.portadaValida=!1,a.$on("archivoPrincipal",function(b,c){a.$apply(function(){a.archivo=c.file,divisiones=a.archivo.name.split("."),a.formatoArchivo=divisiones[divisiones.length-1],a.archivoValido=a.verificarFormato()})}),a.$on("archivoPortada",function(b,c){a.$apply(function(){a.portada=c.file,divisiones=a.portada.name.split("."),a.formatoPortada=divisiones[divisiones.length-1],a.portadaValida=a.verificarImagen(a.formatoPortada)})}),a.verificarFormato=function(){if(otrosFormatos=["pdf","mp3","aac","wma","mp4","mpeg","avi","3gp"],a.archivoImagen=a.verificarImagen(a.formatoArchivo),1==a.archivoImagen)return a.portadaValida=!0,!0;for(a.portadaValida=a.verificarImagen(a.formatoPortada),i=0;i<otrosFormatos.length;i++)if(a.formatoArchivo==otrosFormatos[i])return!0;return!1},a.verificarImagen=function(a){for(formatosImagen=["png","gif","jpg","jpeg","bmp","tiff"],i=0;i<formatosImagen.length;i++)if(a==formatosImagen[i])return!0;return!1},a.validar=function(){return!(!a.archivoValido||!a.portadaValida||a.subirobra.$invalid)}}]),app.service("peticionObras",["$http",function(a){this.get=function(b,c){a({method:"GET",url:"http://localhost:8000/api/works"}).success(function(a){b(a)}).error(function(a,b){c(a,b)})}}]),app.service("peticionPromotores",["$http",function(a){this.get=function(b,c,d,e,f){a({method:"GET",url:"data/promotores"+f+".json"}).success(function(a){b(a)}).error(function(a,b){c(a,b)})}}]);